.studio-shell {
  --studio-bg: #f7f8fb;
  --studio-panel: #ffffff;
  --studio-panel-muted: #f3f4f7;
  --studio-ink: #111827;
  --studio-copy: #374151;
  --studio-subtle: #6b7280;
  --studio-border: #d8dce3;
  --studio-shadow: 0 20px 36px -34px rgba(17, 24, 39, 0.55);
  --studio-signal-positive: #dc2626;
  --studio-signal-negative: #2563eb;
  --studio-output-active: #166534;
  --studio-hero-grad-a: #eef0f5;
  --studio-hero-grad-b: #ffffff;
  --studio-hero-grad-c: #f4f5f9;
  --studio-card-grad-a: rgba(255, 255, 255, 0.97);
  --studio-card-grad-b: rgba(243, 244, 247, 0.95);
  display: grid;
  gap: 12px;
  color: var(--studio-ink);
}

.studio-hero {
  border: 1px solid var(--studio-border);
  border-radius: 18px;
  padding: 14px 16px;
  background:
    radial-gradient(120% 170% at 0% -25%, var(--studio-hero-grad-a) 0%, transparent 58%),
    linear-gradient(145deg, var(--studio-hero-grad-b) 0%, var(--studio-hero-grad-c) 100%);
  box-shadow: var(--studio-shadow);
  display: grid;
  grid-template-columns: minmax(0, 1fr) auto;
  align-items: center;
  gap: 10px 14px;
}

.studio-hero-copy {
  min-width: 0;
}

.studio-eyebrow {
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-weight: 700;
  font-size: 11px;
  color: var(--studio-subtle);
}

.studio-title {
  margin: 4px 0 0;
  font-size: clamp(1.2rem, 2.1vw, 1.8rem);
  letter-spacing: -0.01em;
}

.studio-subtitle {
  margin: 4px 0 0;
  color: var(--studio-copy);
  max-width: 52ch;
  line-height: 1.45;
  font-size: 0.9rem;
}

.studio-runtime {
  display: flex;
  flex-wrap: wrap;
  justify-content: flex-end;
  gap: 6px;
  max-width: 560px;
}

.studio-hero-tools {
  display: grid;
  gap: 8px;
  justify-items: end;
}

.studio-runtime-pill {
  border-radius: 999px;
  border: 1px solid var(--studio-border);
  background: var(--studio-panel);
  color: var(--studio-subtle);
  padding: 5px 10px;
  font-size: 11px;
  display: inline-flex;
  gap: 6px;
}

.studio-runtime-pill strong {
  color: var(--studio-ink);
}

.studio-runtime-pill-optional {
  opacity: 0.88;
}

.studio-mode-toggle {
  display: inline-flex;
  flex-wrap: wrap;
  gap: 6px;
  justify-content: flex-end;
}

.studio-mode-chip {
  border-radius: 999px;
  border: 1px solid var(--studio-border);
  background: var(--studio-panel-muted);
  color: var(--studio-copy);
  padding: 5px 10px;
  font-size: 11px;
  font-weight: 700;
}

.studio-mode-chip.is-active {
  border-color: #111827;
  background: #111827;
  color: #f8fafc;
}

.studio-card {
  border: 1px solid var(--studio-border);
  border-radius: 22px;
  padding: 20px;
  background:
    linear-gradient(180deg, var(--studio-card-grad-a) 0%, var(--studio-card-grad-b) 100%);
  box-shadow: var(--studio-shadow);
}

.studio-card-head h3 {
  margin: 0;
  font-size: 1.1rem;
}

.studio-card-head p {
  margin: 6px 0 0;
  color: var(--studio-copy);
  font-size: 0.9rem;
  line-height: 1.5;
}

.studio-quality-grid {
  margin-top: 12px;
  display: grid;
  gap: 10px;
  grid-template-columns: repeat(3, minmax(0, 1fr));
}

.studio-quality-panel {
  border: 1px solid var(--studio-border);
  border-radius: 12px;
  background: #f9fafb;
  padding: 10px;
}

.studio-quality-panel h4 {
  margin: 0;
  font-size: 0.9rem;
}

.studio-quality-list {
  margin-top: 8px;
  display: grid;
  gap: 6px;
}

.studio-quality-list p,
.studio-quality-line {
  margin: 0;
  display: flex;
  justify-content: space-between;
  gap: 8px;
  font-size: 12px;
  color: var(--studio-copy);
}

.studio-quality-compare {
  margin-top: 8px;
  display: grid;
  gap: 6px;
}

.studio-quality-compare-head,
.studio-quality-compare-row {
  margin: 0;
  display: grid;
  grid-template-columns: minmax(0, 1fr) 58px 58px;
  gap: 8px;
  align-items: center;
  font-size: 11px;
  color: var(--studio-copy);
}

.studio-quality-compare-head {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--studio-subtle);
}

.studio-quality-compare-head span:nth-child(2),
.studio-quality-compare-head span:nth-child(3),
.studio-quality-compare-row strong:nth-child(2),
.studio-quality-compare-row strong:nth-child(3) {
  text-align: right;
}

.studio-mlp-layout {
  display: grid;
  grid-template-columns: minmax(260px, 320px) minmax(0, 1fr);
  gap: 16px;
  margin-top: 14px;
}

.studio-mlp-layout-single {
  grid-template-columns: minmax(260px, 340px);
}

.studio-pad-wrap .deep-panel {
  border: none;
  box-shadow: none;
  background: transparent;
  padding: 0;
}

.studio-pad-wrap .deep-section-head {
  margin-bottom: 10px;
}

.studio-pad-wrap .deep-section-title {
  font-size: 0.98rem;
}

.studio-pad-wrap .deep-section-subtitle,
.studio-pad-wrap .deep-feature-copy {
  color: var(--studio-copy);
  margin-bottom: 0;
}

.studio-pad-wrap .deep-mnist-canvas-wrap {
  border: 1px solid var(--studio-border);
  border-radius: 14px;
  padding: 10px;
  background: var(--studio-panel);
  width: min(100%, 300px);
}

.studio-pad-wrap .deep-step-row {
  width: min(100%, 300px);
  padding-inline: 10px;
  justify-content: flex-start;
  gap: 8px;
  margin-top: 8px;
}

.studio-pad-wrap .deep-step-chip {
  border-color: var(--studio-border);
  background: var(--studio-panel);
}

.studio-pad-wrap .deep-step-chip-primary {
  border-color: hsl(var(--accent) / 0.5);
  color: hsl(var(--text-primary));
  background: hsl(var(--accent) / 0.16);
  box-shadow: inset 0 0 0 1px hsl(var(--accent) / 0.2);
}

.studio-pad-wrap .deep-step-chip-primary:hover {
  border-color: hsl(var(--accent) / 0.62);
  background: hsl(var(--accent) / 0.22);
}

.studio-graph-wrap {
  min-width: 0;
}

.studio-cnn-live-wrap .deep-panel {
  border: none;
  box-shadow: none;
  background: transparent;
  padding: 0;
}

.studio-cnn-live-wrap .deep-section-head {
  margin-bottom: 8px;
}

.studio-cnn-live-wrap .deep-section-title {
  font-size: 0.98rem;
}

.studio-cnn-live-wrap .deep-section-subtitle,
.studio-cnn-live-wrap .deep-feature-copy {
  color: var(--studio-copy);
}

.studio-cnn-live-wrap .deep-step-chip {
  padding: 5px 9px;
  font-size: 11px;
}

.studio-cnn-live-wrap .deep-step-row {
  margin-bottom: 6px;
}

.studio-predict-card {
  padding: 14px;
  border-color: hsl(var(--border-subtle));
  background: hsl(var(--surface-material) / var(--opacity-material-soft));
  backdrop-filter: saturate(130%) blur(var(--blur-md));
  box-shadow: 0 12px 30px -22px hsl(var(--shadow-soft) / 0.5);
}

.studio-predict-layout {
  display: grid;
  grid-template-columns: minmax(290px, 344px) minmax(0, 1fr);
  gap: 14px;
  align-items: stretch;
}

.studio-predict-pad {
  min-width: 0;
  display: grid;
  gap: 10px;
}

.studio-predict-output-tile {
  border: 1px solid hsl(var(--border-subtle));
  border-radius: var(--radius-md, 16px);
  background: hsl(var(--surface-elevated) / 0.88);
  box-shadow: 0 8px 18px -20px hsl(var(--shadow-soft) / 0.45);
  padding: 10px;
  width: 100%;
}

.studio-predict-output-tile .deep-feature-copy {
  margin: 0;
  font-size: 0.8rem;
  line-height: 1.4;
  color: hsl(var(--text-secondary));
}

.studio-predict-output-bars {
  margin-top: 8px;
}

.studio-cnn-live-wrap-compact {
  min-width: 0;
  border: 1px solid hsl(var(--border-subtle));
  border-radius: var(--radius-md, 16px);
  background: hsl(var(--surface-material) / var(--opacity-material-soft));
  backdrop-filter: saturate(130%) blur(var(--blur-md));
  box-shadow: 0 12px 30px -22px hsl(var(--shadow-soft) / 0.5);
  padding: 10px;
}

.studio-cnn-live-wrap-compact .deep-panel {
  gap: 6px;
}

.studio-cnn-live-wrap-compact .studio-cnn-predict-head {
  margin-bottom: 5px;
}

.studio-cnn-live-wrap-compact .deep-section-title {
  font-size: 0.94rem;
  letter-spacing: -0.01em;
  color: hsl(var(--text-primary));
}

.studio-cnn-live-wrap-compact .deep-section-subtitle {
  font-size: 0.78rem;
  line-height: 1.35;
  max-width: 56ch;
  color: hsl(var(--text-secondary));
}

.studio-cnn-live-wrap-compact .studio-cnn-stage-strip {
  margin-bottom: 6px;
  gap: 4px;
}

.studio-cnn-live-wrap-compact .studio-cnn-stage-chip {
  border-radius: 999px;
  padding: 4px 6px;
  font-size: 10px;
  min-height: 24px;
}

.studio-cnn-live-wrap-compact .studio-cnn-stage-chip span {
  width: 14px;
  height: 14px;
  font-size: 9px;
}

.studio-cnn-live-wrap-compact .studio-cnn-step-row-compact {
  margin-bottom: 4px;
  flex-wrap: wrap;
  gap: 6px;
}

.studio-cnn-live-wrap-compact .deep-step-chip {
  padding: 4px 8px;
  font-size: 10px;
  border-color: hsl(var(--border-subtle));
  background: hsl(var(--surface-elevated) / 0.84);
  color: hsl(var(--text-secondary));
}

.studio-cnn-live-wrap-compact .deep-pill {
  font-size: 10px;
  border-color: hsl(var(--border-subtle));
  background: hsl(var(--surface-elevated) / 0.82);
  color: hsl(var(--text-secondary));
}

.studio-cnn-live-wrap-compact .studio-cnn-stage-caption-compact {
  font-size: 0.79rem;
  line-height: 1.35;
  margin-top: 0;
}

.studio-cnn-compact-subcopy {
  margin: 0;
  font-size: 0.76rem;
}

.studio-cnn-compact-flow {
  margin-bottom: 4px;
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
}

.studio-cnn-compact-pill {
  border: 1px solid hsl(var(--border-subtle));
  border-radius: 999px;
  background: hsl(var(--surface-elevated) / 0.84);
  color: hsl(var(--text-secondary));
  font-size: 10px;
  line-height: 1;
  padding: 4px 8px;
}

.studio-cnn-compact-pill.is-active {
  border-color: hsl(var(--accent) / 0.52);
  background: hsl(var(--accent) / 0.16);
  color: hsl(var(--text-primary));
  box-shadow: inset 0 0 0 1px hsl(var(--accent) / 0.22);
}

.studio-cnn-speed-control-compact {
  margin-left: auto;
}

.studio-cnn-speed-control-compact span {
  font-size: 10px;
}

.studio-cnn-speed-control-compact select {
  min-width: 90px;
}

.studio-cnn-pill-compact {
  font-size: 10px;
}

.studio-cnn-live-wrap-compact .studio-cnn-predict-primer {
  margin-top: 2px;
}

.studio-cnn-live-wrap-compact .studio-cnn-predict-primer .deep-feature-copy {
  font-size: 0.77rem;
  line-height: 1.38;
  margin: 0;
}

.studio-cnn-live-wrap-compact .studio-cnn-zone-grid-compact {
  margin-top: 6px;
  grid-template-columns: minmax(0, 1fr);
  gap: 8px;
}

.studio-cnn-compact-stack {
  margin-top: 4px;
  display: grid;
  gap: 6px;
}

.studio-cnn-explain-grid {
  display: grid;
  gap: 6px;
  grid-template-columns: repeat(3, minmax(0, 1fr));
}

.studio-cnn-explain-tile {
  border: 1px solid hsl(var(--border-subtle));
  border-radius: 10px;
  background: hsl(var(--surface-elevated) / 0.84);
  box-shadow: 0 8px 18px -20px hsl(var(--shadow-soft) / 0.42);
  padding: 8px;
  min-height: 74px;
}

.studio-cnn-explain-tile .deep-mini-title {
  margin: 0 0 4px;
  font-size: 10px;
  color: hsl(var(--text-tertiary));
}

.studio-cnn-explain-tile .deep-feature-copy {
  margin: 0;
  font-size: 11px;
  line-height: 1.35;
  color: hsl(var(--text-secondary));
}

.studio-cnn-explain-tile.is-active {
  border-color: hsl(var(--accent) / 0.52);
  background: hsl(var(--accent) / 0.1);
  box-shadow: inset 0 0 0 1px hsl(var(--accent) / 0.2);
}

.studio-cnn-explain-fyi {
  margin: 0;
  font-size: 11px;
  line-height: 1.35;
  color: hsl(var(--text-secondary));
  border: 1px dashed hsl(var(--border-subtle));
  border-radius: 8px;
  background: hsl(var(--surface-elevated) / 0.82);
  padding: 6px 8px;
}

.studio-cnn-live-wrap-compact .deep-zone-visual {
  min-width: 0;
  border-color: hsl(var(--border-subtle));
  background: hsl(var(--surface-elevated) / 0.86);
}

.studio-cnn-live-wrap-compact .deep-zone-visual-large {
  min-height: 252px;
}

.studio-cnn-live-wrap-compact .deep-cnn-window-grid {
  grid-template-columns: minmax(0, 1fr);
  gap: 8px;
}

.studio-cnn-live-wrap-compact .studio-cnn-output-cluster {
  grid-template-columns: minmax(0, 1fr);
}

.studio-cnn-live-wrap-compact .studio-cnn-math-tooltip {
  max-width: none;
  border-color: hsl(var(--border-subtle));
  background: hsl(var(--surface-elevated) / 0.88);
}

.studio-cnn-predict-output-info .deep-feature-copy {
  font-size: 0.78rem;
  line-height: 1.4;
}

.studio-cnn-predict-summary {
  margin-top: 8px;
  border: 1px solid var(--studio-border);
  border-radius: 10px;
  background: var(--studio-panel-muted);
  padding: 8px;
  display: grid;
  gap: 6px;
}

.studio-cnn-predict-summary p {
  margin: 0;
  font-size: 11px;
  line-height: 1.4;
  color: var(--studio-copy);
}

.studio-cnn-predict-summary .studio-cnn-predict-warning {
  color: var(--studio-ink);
}

.studio-cnn-stage-strip {
  margin-bottom: 8px;
  display: grid;
  grid-template-columns: repeat(6, minmax(0, 1fr));
  gap: 6px;
}

.studio-cnn-stage-chip {
  border: 1px solid var(--studio-border);
  border-radius: 10px;
  background: var(--studio-panel-muted);
  color: var(--studio-copy);
  padding: 5px 6px;
  font-size: 11px;
  display: inline-flex;
  gap: 5px;
  align-items: center;
  justify-content: center;
  transition: background-color 180ms ease, border-color 180ms ease;
}

.studio-cnn-stage-chip span {
  width: 16px;
  height: 16px;
  border-radius: 999px;
  border: 1px solid #cbd5e1;
  display: inline-grid;
  place-items: center;
  font-size: 10px;
  color: var(--studio-subtle);
  background: #fff;
}

.studio-cnn-stage-chip.is-active {
  border-color: #1f2937;
  color: #111827;
  background: #e5e7eb;
}

.studio-cnn-stage-chip.is-active span {
  border-color: #1f2937;
  color: #111827;
}

.studio-cnn-stage-strip.is-compact {
  grid-template-columns: repeat(6, minmax(0, 1fr));
}

.studio-cnn-hyper-grid {
  margin: 8px 0 10px;
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 8px;
}

.studio-cnn-live-wrap .deep-zone-grid {
  margin-top: 8px;
}

.studio-cnn-live-wrap .deep-cnn-window-grid {
  grid-template-columns: minmax(190px, 1.05fr) minmax(96px, 0.42fr) minmax(250px, 1.45fr);
  align-items: start;
}

.studio-cnn-live-wrap .deep-zone-info {
  border: 1px solid var(--studio-border);
  border-radius: 12px;
  background: #f9fafb;
}

.studio-cnn-live-wrap .deep-matrix-card {
  border-color: var(--studio-border);
}

.studio-cnn-live-wrap .studio-cnn-output-cluster {
  display: grid;
  gap: 8px;
  grid-template-columns: minmax(170px, 1fr) minmax(165px, 0.92fr);
  align-items: start;
}

.studio-cnn-live-wrap .studio-cnn-math-tooltip {
  border: 1px solid var(--studio-border);
  border-radius: 10px;
  background: #f8fafc;
  padding: 8px;
  box-shadow: 0 10px 20px -18px rgba(17, 24, 39, 0.5);
}

.studio-cnn-live-wrap .deep-cnn-window-grid > .deep-matrix-card:nth-child(2) {
  max-width: 136px;
  justify-self: center;
}

.studio-cnn-live-wrap .deep-matrix-card {
  min-height: 0;
}

.studio-cnn-live-wrap .deep-matrix-scroll {
  overflow: hidden;
  max-height: none;
}

.studio-cnn-live-wrap .deep-matrix-grid {
  justify-content: center;
}

.studio-cnn-live-wrap .studio-cnn-math-matrix {
  margin-top: 6px;
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 6px;
}

.studio-cnn-live-wrap .studio-cnn-math-cell {
  border: 1px solid #d9dee8;
  border-radius: 8px;
  background: #ffffff;
  padding: 5px;
  min-height: 44px;
  display: grid;
  gap: 3px;
  align-content: start;
  transition: border-color 180ms ease, background-color 180ms ease, box-shadow 180ms ease;
}

.studio-cnn-live-wrap .studio-cnn-math-cell span {
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size: 10px;
  color: var(--studio-subtle);
}

.studio-cnn-live-wrap .studio-cnn-math-cell strong {
  font-size: 11px;
  color: var(--studio-copy);
}

.studio-cnn-live-wrap .studio-cnn-math-cell.is-active {
  border-color: #94a3b8;
  background: #eef2ff;
  box-shadow: inset 0 0 0 1px rgba(59, 130, 246, 0.35);
}

.studio-cnn-live-wrap .studio-cnn-math-sum {
  margin: 8px 0 0;
  font-size: 12px;
  color: var(--studio-copy);
}

.studio-cnn-live-wrap .studio-cnn-op-list {
  margin-top: 8px;
  border-top: 1px dashed #cbd5e1;
  padding-top: 8px;
  display: grid;
  gap: 4px;
}

.studio-cnn-live-wrap .studio-cnn-op-list p {
  margin: 0;
  font-size: 12px;
  color: var(--studio-copy);
}

.studio-mlp-shell {
  display: grid;
  gap: 12px;
}

.studio-network-head h4 {
  margin: 0;
  font-size: 1rem;
}

.studio-network-head p {
  margin: 5px 0 0;
  font-size: 0.87rem;
  color: var(--studio-copy);
  line-height: 1.45;
}

.studio-network-stage {
  border: 1px solid var(--studio-border);
  border-radius: 16px;
  padding: 12px;
  background:
    linear-gradient(180deg, #f9fafc 0%, #f4f6fa 100%);
  overflow: auto;
}

.studio-network-svg {
  width: 100%;
  min-width: 700px;
  height: auto;
}

.studio-layer-title {
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 0.02em;
  fill: #6b7280;
}

.studio-edge {
  opacity: 0;
  transition: opacity 220ms ease, stroke-width 220ms ease;
}

.studio-edge-ghost {
  opacity: 0;
  transition: opacity 220ms ease;
}

.studio-edge.is-visible {
  opacity: 0.86;
}

.studio-node {
  stroke: #eef2f7;
  stroke-width: 1.5px;
}

.studio-node-input {
  fill: #9ca3af;
}

.studio-node-hidden {
  fill: #4b5563;
  cursor: pointer;
  transition: transform 180ms ease, fill 180ms ease;
}

.studio-node-hidden.is-active {
  fill: #111827;
}

.studio-node-output {
  fill: #6b7280;
}

.studio-node-output.is-active {
  fill: var(--studio-output-active);
}

.studio-node-label {
  font-size: 10px;
  text-anchor: middle;
  fill: #f8fafc;
  pointer-events: none;
}

.studio-output-index,
.studio-hidden-index {
  text-anchor: start;
  fill: #4b5563;
  font-size: 11px;
  font-weight: 600;
}

.studio-math-card {
  border: 1px solid var(--studio-border);
  border-radius: 16px;
  background: var(--studio-panel);
  padding: 14px;
  display: grid;
  gap: 10px;
}

.studio-math-head {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px 12px;
}

.studio-math-head h5 {
  margin: 0;
  font-size: 0.92rem;
}

.studio-math-head p {
  margin: 0;
  font-size: 0.84rem;
  color: var(--studio-copy);
}

.studio-clear-pin {
  border: 1px solid var(--studio-border);
  border-radius: 999px;
  padding: 5px 9px;
  background: var(--studio-panel-muted);
  color: var(--studio-copy);
  font-size: 12px;
}

.studio-math-empty {
  margin: 0;
  padding: 10px 12px;
  border-radius: 10px;
  background: #f3f4f6;
  color: var(--studio-copy);
  font-size: 0.86rem;
}

.studio-math-grid {
  display: grid;
  gap: 12px;
  grid-template-columns: 1.35fr minmax(220px, 1fr);
}

.studio-equation-template {
  margin: 0;
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size: 12px;
  color: var(--studio-subtle);
}

.studio-term-columns {
  margin-top: 10px;
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 8px;
}

.studio-term-group {
  display: grid;
  gap: 6px;
  align-content: start;
}

.studio-term-head {
  margin: 0;
  font-size: 11px;
  font-weight: 700;
  color: var(--studio-copy);
}

.studio-term-head.is-positive {
  color: var(--studio-signal-positive);
}

.studio-term-head.is-negative {
  color: var(--studio-signal-negative);
}

.studio-term {
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  background: #f9fafb;
  color: #374151;
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size: 11px;
  line-height: 1.35;
  padding: 6px;
}

.studio-term.is-positive {
  border-color: rgba(220, 38, 38, 0.25);
}

.studio-term.is-negative {
  border-color: rgba(37, 99, 235, 0.25);
}

.studio-term-empty {
  margin: 0;
  border-radius: 8px;
  border: 1px dashed #d1d5db;
  background: #f9fafb;
  color: var(--studio-subtle);
  font-size: 11px;
  padding: 6px 8px;
}

.studio-term-footnote {
  margin: 10px 0 0;
  font-size: 11px;
  color: var(--studio-subtle);
}

.studio-z-bar-shell {
  margin-top: 8px;
  border: 1px solid #e5e7eb;
  border-radius: 10px;
  background: #f8fafc;
  padding: 8px;
}

.studio-z-bar-track {
  height: 10px;
  border-radius: 999px;
  background: #e5e7eb;
  overflow: hidden;
  display: flex;
}

.studio-z-bar-track span {
  height: 100%;
  display: block;
  transition: width 220ms ease;
}

.studio-z-bar-track span.is-negative {
  background: rgba(37, 99, 235, 0.72);
}

.studio-z-bar-track span.is-positive {
  background: rgba(220, 38, 38, 0.75);
}

.studio-z-bar-copy {
  margin: 8px 0 0;
  font-size: 12px;
  color: var(--studio-copy);
}

.studio-equation-result {
  margin: 10px 0 0;
  border-radius: 8px;
  background: #f3f4f6;
  padding: 8px 10px;
  font-size: 0.83rem;
  color: var(--studio-copy);
}

.studio-output-panel {
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  background: #f9fafb;
  padding: 10px;
}

.studio-mini-label {
  margin: 0;
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  font-weight: 700;
  color: var(--studio-subtle);
}

.studio-output-bars {
  margin-top: 8px;
  display: grid;
  gap: 6px;
}

.studio-output-row,
.studio-bar-row {
  display: grid;
  grid-template-columns: 22px 1fr 54px;
  gap: 8px;
  align-items: center;
  font-size: 12px;
  color: var(--studio-copy);
}

.studio-output-track,
.studio-bar-track {
  height: 8px;
  border-radius: 999px;
  background: #e5e7eb;
  overflow: hidden;
}

.studio-output-track span,
.studio-bar-track span {
  display: block;
  height: 100%;
  border-radius: inherit;
  background: #6b7280;
}

.studio-output-track span.is-active,
.studio-bar-track span.is-active {
  background: var(--studio-output-active);
}

.studio-node-impact {
  margin: 10px 0 0;
  font-size: 0.82rem;
  color: var(--studio-copy);
}

.studio-network-empty {
  border: 1px dashed #cbd5e1;
  border-radius: 14px;
  background: #f8fafc;
  color: var(--studio-copy);
  font-size: 0.9rem;
  line-height: 1.45;
  padding: 20px;
}

.studio-cnn-grid {
  margin-top: 12px;
  display: grid;
  gap: 10px;
  grid-template-columns: repeat(3, minmax(0, 1fr));
}

.studio-cnn-box {
  border: 1px solid var(--studio-border);
  border-radius: 14px;
  background: var(--studio-panel);
  padding: 10px;
  display: grid;
  gap: 8px;
}

.studio-cnn-placeholder {
  aspect-ratio: 1;
  border-radius: 10px;
  border: 1px dashed #cbd5e1;
  background:
    linear-gradient(0deg, rgba(107, 114, 128, 0.08) 1px, transparent 1px) 0 0 / 16px 16px,
    linear-gradient(90deg, rgba(107, 114, 128, 0.08) 1px, transparent 1px) 0 0 / 16px 16px,
    #f9fafb;
}

.studio-cnn-placeholder-output {
  background:
    linear-gradient(0deg, rgba(107, 114, 128, 0.08) 1px, transparent 1px) 0 0 / 16px 16px,
    linear-gradient(90deg, rgba(107, 114, 128, 0.08) 1px, transparent 1px) 0 0 / 16px 16px,
    radial-gradient(circle at 35% 40%, rgba(17, 24, 39, 0.16) 0%, transparent 38%),
    #f9fafb;
}

.studio-cnn-controls {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.studio-button {
  border: 1px solid var(--studio-border);
  border-radius: 999px;
  padding: 6px 10px;
  font-size: 12px;
  background: #f3f4f6;
  color: #4b5563;
}

.studio-cnn-math {
  margin: 0;
  font-size: 0.84rem;
  color: var(--studio-copy);
}

.studio-diagnostics-grid {
  margin-top: 12px;
  display: grid;
  gap: 12px;
  grid-template-columns: minmax(220px, 260px) 1fr;
}

.studio-diag-micro-grid {
  margin-top: 8px;
  display: grid;
  gap: 8px;
  grid-template-columns: repeat(3, minmax(0, 1fr));
}

.studio-diag-micro-card {
  border: 1px solid var(--studio-border);
  border-radius: 12px;
  background: var(--studio-panel-muted);
  padding: 8px;
  display: grid;
  gap: 7px;
  align-content: start;
}

.studio-diag-micro-card .studio-bar-list {
  margin-top: 0;
}

.studio-diag-micro-card .studio-bar-row {
  grid-template-columns: 46px 1fr 46px;
  gap: 6px;
  font-size: 11px;
}

.studio-diag-micro-card .studio-help-tip {
  width: 188px;
}

.studio-diag-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.studio-help-dot {
  position: relative;
  width: 20px;
  height: 20px;
  border-radius: 999px;
  border: 1px solid #cbd5e1;
  background: #f8fafc;
  color: #475569;
  font-size: 11px;
  font-weight: 700;
  display: inline-grid;
  place-items: center;
  cursor: help;
}

.studio-help-tip {
  position: absolute;
  right: 0;
  top: 24px;
  width: 210px;
  border: 1px solid #cbd5e1;
  border-radius: 10px;
  background: #ffffff;
  color: var(--studio-copy);
  font-size: 11px;
  line-height: 1.45;
  padding: 8px;
  box-shadow: 0 10px 22px -18px rgba(17, 24, 39, 0.65);
  opacity: 0;
  pointer-events: none;
  transition: opacity 160ms ease;
  z-index: 5;
}

.studio-help-dot:hover .studio-help-tip,
.studio-help-dot:focus .studio-help-tip {
  opacity: 1;
}

.studio-diag-card {
  border: 1px solid var(--studio-border);
  border-radius: 14px;
  background: var(--studio-panel);
  padding: 10px;
  position: relative;
}

.studio-surface-canvas {
  margin-top: 8px;
  width: 100%;
  max-width: 220px;
  border-radius: 10px;
  border: 1px solid #d1d5db;
  display: block;
}

.studio-axis-row {
  margin-top: 6px;
  width: 220px;
  display: flex;
  justify-content: space-between;
  font-size: 11px;
  color: #6b7280;
}

.studio-axis-col {
  position: absolute;
  left: 6px;
  top: 43px;
  height: 220px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  font-size: 11px;
  color: #6b7280;
}

.studio-empty-copy {
  margin: 10px 0 0;
  font-size: 0.84rem;
  color: var(--studio-copy);
}

.studio-bar-list {
  margin-top: 10px;
  display: grid;
  gap: 7px;
}

.studio-surface-stat {
  margin: 10px 0 0;
  font-size: 0.84rem;
  color: var(--studio-copy);
}

.studio-metrics-details {
  border: 1px solid var(--studio-border);
  border-radius: 16px;
  background: linear-gradient(180deg, #ffffff, #f8fafc);
  box-shadow: var(--studio-shadow);
  overflow: hidden;
}

.studio-metrics-details > summary {
  cursor: pointer;
  list-style: none;
  padding: 12px 14px;
  font-weight: 700;
  font-size: 0.95rem;
  color: var(--studio-ink);
  border-bottom: 1px solid var(--studio-border);
}

.studio-metrics-details > summary::-webkit-details-marker {
  display: none;
}

.studio-flow-wrap {
  padding: 14px;
  display: grid;
  gap: 12px;
}

.studio-flow-toolbar {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.studio-flow-model {
  border: 1px solid var(--studio-border);
  border-radius: 999px;
  background: #f3f4f6;
  color: var(--studio-copy);
  padding: 6px 12px;
  font-size: 12px;
  font-weight: 700;
}

.studio-flow-model.is-active {
  background: #111827;
  color: #f9fafb;
  border-color: #111827;
}

.studio-flow-track {
  display: grid;
  gap: 8px;
  grid-template-columns: repeat(4, minmax(0, 1fr));
}

.studio-flow-node {
  position: relative;
  border: 1px solid var(--studio-border);
  background: #f3f4f6;
  color: var(--studio-copy);
  border-radius: 12px;
  min-height: 64px;
  padding: 8px;
  display: grid;
  gap: 6px;
  justify-items: start;
  align-content: start;
}

.studio-flow-index {
  width: 22px;
  height: 22px;
  border-radius: 999px;
  border: 1px solid #9ca3af;
  display: inline-grid;
  place-items: center;
  font-size: 12px;
}

.studio-flow-label {
  font-size: 12px;
  font-weight: 700;
}

.studio-flow-node:not(:last-child)::after {
  content: 'â†’';
  position: absolute;
  right: -14px;
  top: 50%;
  transform: translateY(-50%);
  color: #9ca3af;
  font-size: 15px;
  font-weight: 700;
}

.studio-flow-node.is-active {
  background: #111827;
  color: #f9fafb;
  border-color: #111827;
}

.studio-flow-node.is-active .studio-flow-index {
  border-color: #f9fafb;
}

.studio-flow-panel {
  border: 1px solid var(--studio-border);
  border-radius: 12px;
  background: #f9fafb;
  padding: 12px;
}

.studio-flow-panel h4 {
  margin: 0;
  font-size: 0.95rem;
}

.studio-flow-panel p {
  margin: 8px 0 0;
  color: var(--studio-copy);
  font-size: 0.87rem;
  line-height: 1.5;
}

.studio-mini-graphic {
  margin-top: 10px;
  border: 1px solid #d1d5db;
  border-radius: 10px;
  background: #fff;
  padding: 10px;
}

.studio-mini-bar {
  height: 10px;
  border-radius: 999px;
  background: #e5e7eb;
  overflow: hidden;
}

.studio-mini-bar > span {
  display: block;
  height: 100%;
  background: #111827;
}

.studio-flow-animate {
  animation: studioFlowFade 260ms ease;
}

@keyframes studioFlowFade {
  from {
    opacity: 0.35;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.studio-flow-grid16 {
  margin-top: 8px;
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 4px;
}

.studio-flow-grid16 > span {
  display: block;
  border-radius: 4px;
  min-height: 16px;
  background: #111827;
  transition: opacity 220ms ease;
}

.studio-flow-bars {
  margin-top: 8px;
  display: grid;
  gap: 6px;
}

.studio-flow-bar-row {
  display: grid;
  grid-template-columns: 28px 1fr 58px;
  gap: 8px;
  align-items: center;
  font-size: 12px;
  color: var(--studio-copy);
}

.studio-flow-dims {
  margin-top: 8px;
  border: 1px dashed #cbd5e1;
  border-radius: 8px;
  padding: 8px;
  display: grid;
  grid-template-columns: auto auto auto auto auto;
  gap: 6px;
  align-items: center;
  justify-content: start;
  font-size: 12px;
  color: var(--studio-copy);
}

.studio-flow-arrow {
  color: #64748b;
  font-weight: 700;
}

.studio-nn-control-grid {
  margin-top: 10px;
  display: grid;
  gap: 8px;
  grid-template-columns: repeat(5, minmax(0, 1fr));
}

.studio-nn-learn-grid {
  margin-top: 10px;
  display: grid;
  gap: 10px;
  grid-template-columns: minmax(0, 1.3fr) minmax(0, 0.8fr);
  align-items: start;
}

.studio-nn-matrix-stack {
  display: grid;
  gap: 8px;
}

.studio-nn-mini-matrix {
  border: 1px solid var(--studio-border);
  border-radius: 12px;
  background: var(--studio-panel-muted);
  padding: 8px;
}

.studio-nn-mini-grid {
  margin-top: 8px;
  display: grid;
  gap: 4px;
}

.studio-nn-mini-grid span {
  border: 1px solid #d6dbe4;
  border-radius: 7px;
  background: #ffffff;
  color: var(--studio-copy);
  font-size: 11px;
  text-align: center;
  padding: 4px 5px;
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
}

.studio-modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.42);
  z-index: 40;
  display: grid;
  place-items: center;
  padding: 16px;
}

.studio-modal-card {
  width: min(520px, 100%);
  border-radius: 14px;
  border: 1px solid #cbd5e1;
  background: #ffffff;
  padding: 16px;
  box-shadow: 0 24px 46px -30px rgba(15, 23, 42, 0.7);
}

.studio-modal-card h4 {
  margin: 0;
  font-size: 1rem;
}

.studio-modal-card p {
  margin: 8px 0 0;
  font-size: 0.9rem;
  color: var(--studio-copy);
  line-height: 1.5;
}

.studio-modal-actions {
  margin-top: 12px;
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.studio-textbook-shell {
  border: 1px solid var(--studio-border);
  border-radius: 18px;
  background: linear-gradient(180deg, var(--studio-card-grad-a) 0%, var(--studio-card-grad-b) 100%);
  box-shadow: var(--studio-shadow);
  padding: 12px;
  display: grid;
  gap: 10px;
}

.studio-learn2-shell {
  border: 1px solid var(--studio-border);
  border-radius: 16px;
  background: linear-gradient(180deg, var(--studio-card-grad-a) 0%, var(--studio-card-grad-b) 100%);
  box-shadow: var(--studio-shadow);
  padding: 10px;
  display: grid;
  gap: 8px;
}

.studio-learn2-toolbar {
  border: 1px solid var(--studio-border);
  border-radius: 10px;
  background: var(--studio-panel);
  padding: 5px 6px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
  flex-wrap: wrap;
}

.studio-learn2-group {
  display: flex;
  align-items: center;
  gap: 5px;
  flex-wrap: wrap;
}

.studio-learn2-group-label {
  font-size: 10px;
  font-weight: 800;
  color: var(--studio-subtle);
  text-transform: uppercase;
  letter-spacing: 0.04em;
  padding: 0 2px;
}

.studio-learn2-btn {
  border: 1px solid var(--studio-border);
  border-radius: 8px;
  background: var(--studio-panel-muted);
  color: var(--studio-copy);
  font-size: 11px;
  font-weight: 700;
  padding: 4px 8px;
}

.studio-learn2-btn.is-active {
  border-color: #1f2937;
  background: #e5e7eb;
  color: #111827;
}

.studio-learn2-control {
  border: 1px solid var(--studio-border);
  border-radius: 8px;
  background: var(--studio-panel-muted);
  padding: 3px 6px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: var(--studio-copy);
}

.studio-learn2-control select,
.studio-learn2-control input {
  border: none;
  background: transparent;
  color: inherit;
  font-size: 11px;
  outline: none;
}

.studio-learn2-control-range input {
  width: 90px;
}

.studio-learn2-grid {
  display: grid;
  gap: 8px;
}

.studio-learn2-card {
  border: 1px solid var(--studio-border);
  border-radius: 12px;
  background: var(--studio-panel);
  padding: 8px;
  display: grid;
  gap: 7px;
}

.studio-learn2-head h3 {
  margin: 0;
  font-size: 0.95rem;
}

.studio-learn2-head p {
  margin: 3px 0 0;
  color: var(--studio-copy);
  font-size: 0.8rem;
}

.studio-learn2-nn-stage {
  position: relative;
  border: 1px solid var(--studio-border);
  border-radius: 10px;
  background: linear-gradient(180deg, #fafbfe 0%, #f3f5f9 100%);
  padding: 6px;
  min-height: 122px;
}

.studio-learn2-nn-svg {
  width: 100%;
  height: auto;
  display: block;
}

.studio-learn2-label {
  fill: #64748b;
  font-size: 11px;
  font-weight: 700;
}

.studio-learn2-edge {
  stroke: #b8c1d1;
  stroke-width: 1.2;
  opacity: 0.7;
}

.studio-learn2-edge-out {
  stroke: #cf8ea0;
  opacity: 0.78;
}

.studio-learn2-node {
  cursor: crosshair;
  stroke: #eef2f7;
  stroke-width: 1.2px;
}

.studio-learn2-node-input {
  fill: #94a3b8;
}

.studio-learn2-node-h1 {
  fill: #bae6fd;
}

.studio-learn2-node-h2 {
  fill: #a7f3d0;
}

.studio-learn2-node-out {
  fill: #e9d5ff;
}

.studio-learn2-node-out.is-win {
  fill: #d8b4fe;
  stroke: #7c3aed;
}

.studio-learn2-packet-fwd,
.studio-learn2-packet-bwd {
  transition: cx 280ms ease, cy 280ms ease;
}

.studio-learn2-packet-fwd {
  fill: #dc2626;
}

.studio-learn2-packet-bwd {
  fill: #2563eb;
}

.studio-learn2-tip {
  position: absolute;
  transform: translate(-50%, 0);
  border: 1px solid rgba(148, 163, 184, 0.45);
  border-radius: 7px;
  background: rgba(255, 255, 255, 0.9);
  color: #334155;
  font-size: 10px;
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
  padding: 4px 6px;
  line-height: 1.35;
  white-space: nowrap;
  pointer-events: none;
  box-shadow: 0 8px 18px -16px rgba(15, 23, 42, 0.6);
}

.studio-learn2-cnn-stage {
  border: 1px solid var(--studio-border);
  border-radius: 10px;
  background: linear-gradient(180deg, #fafbfe 0%, #f3f5f9 100%);
  padding: 7px;
  position: relative;
}

.studio-learn2-cnn-lane {
  display: grid;
  grid-template-columns: 126px 116px 92px 95px 84px 118px;
  gap: 7px;
  align-items: end;
}

.studio-learn2-stage {
  border: 1px solid var(--studio-border);
  border-radius: 8px;
  background: #f8fafc;
  padding: 5px;
  min-height: 132px;
  display: grid;
  gap: 5px;
  align-content: start;
}

.studio-learn2-stage.is-active {
  border-color: #64748b;
  background: #eef2ff;
}

.studio-learn2-stage p {
  margin: 0;
  font-size: 10px;
  font-weight: 700;
  color: #64748b;
}

.studio-learn2-grid6,
.studio-learn2-grid4,
.studio-learn2-grid2 {
  display: grid;
  gap: 2px;
  border: 1px solid #d5dbe5;
  border-radius: 6px;
  padding: 3px;
  background: #ffffff;
  position: relative;
}

.studio-learn2-grid6 {
  grid-template-columns: repeat(6, minmax(0, 1fr));
}

.studio-learn2-grid4 {
  grid-template-columns: repeat(4, minmax(0, 1fr));
}

.studio-learn2-grid2 {
  grid-template-columns: repeat(2, minmax(0, 1fr));
}

.studio-learn2-grid6 span,
.studio-learn2-grid4 span,
.studio-learn2-grid2 span {
  aspect-ratio: 1;
  border-radius: 2px;
  border: 1px solid rgba(148, 163, 184, 0.25);
  background: #ef4444;
}

.studio-learn2-grid4 span {
  background: #3b82f6;
}

.studio-learn2-grid2 span {
  background: #059669;
}

.studio-learn2-kernel {
  position: absolute;
  width: 50%;
  height: 50%;
  border: 2px solid rgba(239, 68, 68, 0.8);
  background: rgba(239, 68, 68, 0.08);
  transition: top 220ms ease, left 220ms ease;
}

.studio-learn2-flat {
  display: grid;
  gap: 2px;
}

.studio-learn2-flat span {
  border: 1px solid #d8deea;
  border-radius: 5px;
  background: #ffffff;
  color: #94a3b8;
  text-align: center;
  font-size: 10px;
  padding: 2px 4px;
  opacity: 0.25;
  transform: translateX(-10px);
  transition: opacity 200ms ease, transform 200ms ease;
}

.studio-learn2-flat span.is-on {
  opacity: 1;
  transform: translateX(0);
  color: #1f2937;
}

.studio-learn2-dense-lines {
  height: 88px;
  border-radius: 6px;
  border: 1px solid #d8deea;
  background:
    linear-gradient(146deg, transparent 40%, rgba(99, 102, 241, 0.4) 41%, transparent 42%),
    linear-gradient(170deg, transparent 26%, rgba(99, 102, 241, 0.35) 27%, transparent 28%),
    linear-gradient(190deg, transparent 62%, rgba(99, 102, 241, 0.35) 63%, transparent 64%),
    #ffffff;
}

.studio-learn2-pred {
  display: grid;
  gap: 5px;
}

.studio-learn2-pred span {
  border: 1px solid #d8deea;
  border-radius: 999px;
  background: #eef2ff;
  color: #475569;
  font-size: 10px;
  font-weight: 700;
  text-align: center;
  padding: 4px 6px;
}

.studio-learn2-pred span.is-win {
  border-color: #7c3aed;
  color: #5b21b6;
  background: #ede9fe;
}

.studio-learn2-tip-cnn {
  white-space: nowrap;
}

.studio-learn2-tip-cnn-global {
  left: 50%;
  bottom: 6px;
  transform: translate(-50%, 0);
  white-space: nowrap;
}

.studio-learn2-info-card {
  border: 1px solid var(--studio-border);
  border-radius: 8px;
  background: var(--studio-panel-muted);
  padding: 6px 8px;
  display: grid;
  gap: 4px;
}

.studio-learn2-info-card-cnn {
  margin-top: 7px;
}

.studio-learn2-info-title {
  margin: 0;
  font-size: 11px;
  font-weight: 800;
  color: var(--studio-ink);
}

.studio-learn2-info-copy {
  margin: 0;
  font-size: 11px;
  color: var(--studio-copy);
}

.studio-learn2-info-math {
  margin: 0;
  font-size: 11px;
  color: var(--studio-copy);
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
}

.studio-learn2-matrix-panel {
  border: 1px solid var(--studio-border);
  border-radius: 8px;
  background: #f8fafc;
  padding: 6px 8px;
  display: grid;
  gap: 3px;
}

.studio-learn2-matrix-line {
  margin: 0;
  font-size: 10px;
  color: #475569;
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
  line-height: 1.3;
}

.studio-learn2-cnn-lane.is-large {
  grid-template-columns: 236px 190px 160px 130px 160px 150px;
  gap: 10px;
}

.studio-learn2-stage.is-large {
  min-height: 238px;
  padding: 7px;
}

.studio-learn2-grid6.is-large,
.studio-learn2-grid4.is-large,
.studio-learn2-grid2.is-large {
  gap: 3px;
  padding: 5px;
}

.studio-learn2-flat.is-large span {
  font-size: 11px;
  padding: 3px 4px;
}

.studio-learn2-dense-lines.is-large {
  height: 182px;
}

.studio-learn2-pred.is-large span {
  font-size: 11px;
  padding: 6px 8px;
}

.studio-learn2-grid2 span.is-cnn-focus {
  box-shadow: inset 0 0 0 2px rgba(15, 23, 42, 0.45);
}

.studio-learn-toolbar {
  border: 1px solid var(--studio-border);
  border-radius: 12px;
  background: var(--studio-panel);
  padding: 6px 8px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.studio-learn-toolbar-group {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}

.studio-compact-btn {
  border: 1px solid var(--studio-border);
  border-radius: 8px;
  padding: 4px 8px;
  background: var(--studio-panel-muted);
  color: var(--studio-copy);
  font-size: 11px;
  font-weight: 700;
  transition: background-color 140ms ease, border-color 140ms ease;
}

.studio-compact-btn:hover {
  background: #e5e7eb;
  border-color: #9ca3af;
}

.studio-compact-control {
  border: 1px solid var(--studio-border);
  border-radius: 8px;
  background: var(--studio-panel-muted);
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 3px 6px;
  font-size: 11px;
  color: var(--studio-copy);
}

.studio-compact-control select,
.studio-compact-control input {
  border: none;
  outline: none;
  background: transparent;
  color: inherit;
  font-size: 11px;
}

.studio-compact-control-range input {
  width: 92px;
}

.studio-textbook-grid {
  display: grid;
  gap: 10px;
  grid-template-columns: 1fr;
}

.studio-textbook-card {
  border: 1px solid var(--studio-border);
  border-radius: 14px;
  background: var(--studio-panel);
  padding: 10px;
  display: grid;
  gap: 8px;
}

.studio-textbook-head h3 {
  margin: 0;
  font-size: 0.98rem;
}

.studio-textbook-head p {
  margin: 4px 0 0;
  font-size: 0.82rem;
  color: var(--studio-copy);
}

.studio-unrolled-stage {
  position: relative;
  border: 1px solid var(--studio-border);
  border-radius: 12px;
  background: linear-gradient(180deg, #f9fafc 0%, #f2f5fa 100%);
  padding: 8px;
}

.studio-unrolled-svg {
  width: 100%;
  height: auto;
  display: block;
}

.studio-unrolled-layer-labels text {
  fill: #6b7280;
  font-size: 11px;
  font-weight: 700;
}

.studio-edge-line {
  stroke: #b5becd;
  stroke-width: 1.5;
}

.studio-edge-line-mid {
  stroke: #aab4c4;
}

.studio-edge-line-dense {
  stroke: #d06b7a;
  stroke-dasharray: 3 3;
}

.studio-node-input {
  fill: #95a3ba;
  stroke: #ffffff;
  stroke-width: 1.2;
}

.studio-node-pre {
  fill: #d1dae8;
  stroke: #7c8ca8;
  stroke-width: 1.2;
  cursor: crosshair;
}

.studio-node-activation {
  fill: #eef2f8;
  stroke: #6f8bb8;
  stroke-width: 1.2;
  cursor: crosshair;
}

.studio-activation-curve {
  fill: none;
  stroke: #45638d;
  stroke-width: 1.2;
}

.studio-node-hidden {
  fill: #c8f2f7;
  stroke: #3f95a0;
  stroke-width: 1.2;
  cursor: crosshair;
}

.studio-node-output {
  fill: #e7d7ef;
  stroke: #9b75b0;
  stroke-width: 1.2;
  cursor: crosshair;
}

.studio-node-output.is-active {
  fill: #c6a2db;
}

.studio-node-text {
  fill: #1f2937;
  font-size: 11px;
  font-weight: 700;
}

.studio-packet-forward,
.studio-packet-backprop {
  transition: cx 320ms ease, cy 320ms ease;
}

.studio-packet-forward {
  fill: #dc2626;
}

.studio-packet-backprop {
  fill: #2563eb;
}

.studio-inline-math-tip {
  position: absolute;
  transform: translate(-50%, 0);
  border: 1px solid rgba(100, 116, 139, 0.45);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.86);
  backdrop-filter: blur(2px);
  color: #334155;
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size: 11px;
  padding: 5px 7px;
  line-height: 1.35;
  box-shadow: 0 8px 20px -18px rgba(15, 23, 42, 0.7);
  white-space: nowrap;
  pointer-events: none;
}

.studio-cnn-3d-stage {
  position: relative;
  border: 1px solid var(--studio-border);
  border-radius: 12px;
  background: linear-gradient(180deg, #f9fafc 0%, #f4f6fb 100%);
  padding: 10px;
  overflow: hidden;
}

.studio-cnn-overlay {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.studio-frustum {
  fill: rgba(59, 130, 246, 0.08);
  stroke: rgba(59, 130, 246, 0.35);
  stroke-width: 1;
}

.studio-zip-line {
  stroke: rgba(220, 38, 38, 0.52);
  stroke-width: 2;
  stroke-dasharray: 4 3;
}

.studio-cnn-lane {
  display: grid;
  grid-template-columns: 170px 190px 166px 122px 170px;
  gap: 12px;
  align-items: end;
  min-height: 290px;
  position: relative;
}

.studio-cnn-stage-block {
  display: grid;
  gap: 8px;
  justify-items: center;
}

.studio-cnn-stage-block > p {
  margin: 0;
  font-size: 11px;
  font-weight: 700;
  color: #64748b;
}

.studio-plane-stack {
  position: relative;
  width: 156px;
  height: 132px;
}

.studio-plane-stack-pool {
  width: 126px;
  height: 108px;
}

.studio-iso-plane {
  position: absolute;
  inset: 0;
  border: 1px solid #cbd5e1;
  border-radius: 8px;
  transform-style: preserve-3d;
  transform: translateZ(var(--z-offset, 0px)) rotateX(56deg) rotateZ(-45deg);
  background: rgba(255, 255, 255, 0.75);
}

.studio-iso-plane-input {
  width: 158px;
  height: 158px;
  position: relative;
}

.studio-iso-plane-conv {
  width: 156px;
  height: 132px;
}

.studio-iso-plane-pool {
  width: 126px;
  height: 100px;
}

.studio-grid6,
.studio-grid4,
.studio-grid2 {
  width: 100%;
  height: 100%;
  display: grid;
  gap: 2px;
  padding: 4px;
}

.studio-grid6 {
  grid-template-columns: repeat(6, minmax(0, 1fr));
}

.studio-grid4 {
  grid-template-columns: repeat(4, minmax(0, 1fr));
}

.studio-grid2 {
  grid-template-columns: repeat(2, minmax(0, 1fr));
}

.studio-grid6 span,
.studio-grid4 span,
.studio-grid2 span {
  border-radius: 2px;
  background: #ef4444;
  border: 1px solid rgba(148, 163, 184, 0.22);
}

.studio-grid4 span {
  background: #4f7fd8;
}

.studio-grid2 span {
  background: #0f766e;
}

.studio-kernel-window {
  position: absolute;
  width: 50%;
  height: 50%;
  border: 2px solid rgba(239, 68, 68, 0.72);
  background: rgba(239, 68, 68, 0.1);
  transition: left 250ms ease, top 250ms ease;
}

.studio-inline-math-tip-cnn {
  top: 0;
  left: 0;
  transform: translate(-50%, 0);
}

.studio-flatten-col {
  border: 1px solid #cbd5e1;
  border-radius: 8px;
  background: #f8fafc;
  width: 100px;
  padding: 5px;
  display: grid;
  gap: 3px;
}

.studio-flatten-col span {
  border: 1px solid #d4dbe7;
  border-radius: 6px;
  background: #ffffff;
  color: #64748b;
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size: 10px;
  text-align: center;
  padding: 3px 4px;
  opacity: 0.24;
  transform: translateX(-14px);
  transition: opacity 220ms ease, transform 220ms ease;
}

.studio-flatten-col span.is-on {
  opacity: 1;
  transform: translateX(0);
  color: #1f2937;
}

.studio-flatten-col.is-unzipping span.is-on {
  animation: studioFlattenPulse 320ms ease;
}

@keyframes studioFlattenPulse {
  0% {
    box-shadow: 0 0 0 rgba(239, 68, 68, 0);
  }
  50% {
    box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.25);
  }
  100% {
    box-shadow: 0 0 0 rgba(239, 68, 68, 0);
  }
}

.studio-dense-mini {
  position: relative;
  width: 140px;
  min-height: 170px;
  border: 1px solid #cbd5e1;
  border-radius: 10px;
  background: #f8fafc;
  padding: 8px;
  display: grid;
  align-content: center;
  justify-items: center;
}

.studio-dense-edges {
  position: absolute;
  inset: 10px 18px 10px 10px;
  background:
    linear-gradient(145deg, transparent 42%, rgba(79, 70, 229, 0.3) 43%, transparent 44%),
    linear-gradient(165deg, transparent 30%, rgba(79, 70, 229, 0.3) 31%, transparent 32%),
    linear-gradient(192deg, transparent 54%, rgba(79, 70, 229, 0.3) 55%, transparent 56%);
}

.studio-pred-nodes {
  position: relative;
  z-index: 1;
  display: grid;
  gap: 8px;
}

.studio-pred-nodes span {
  border: 1px solid #cbd5e1;
  border-radius: 999px;
  background: #eef2ff;
  color: #334155;
  font-size: 11px;
  font-weight: 700;
  padding: 5px 10px;
  text-align: center;
}

.studio-pred-nodes span.is-win {
  border-color: #7c3aed;
  background: #ede9fe;
  color: #5b21b6;
}

.dark .studio-shell {
  --studio-bg: #0f172a;
  --studio-panel: #121a2a;
  --studio-panel-muted: #182235;
  --studio-ink: #e5e7eb;
  --studio-copy: #cbd5e1;
  --studio-subtle: #94a3b8;
  --studio-border: #273449;
  --studio-shadow: 0 20px 36px -28px rgba(2, 6, 23, 0.85);
  --studio-output-active: #22c55e;
  --studio-hero-grad-a: #172036;
  --studio-hero-grad-b: #131c2d;
  --studio-hero-grad-c: #0f172a;
  --studio-card-grad-a: rgba(18, 26, 42, 0.96);
  --studio-card-grad-b: rgba(14, 21, 34, 0.93);
}

.dark .studio-runtime-pill {
  background: #172235;
}

.dark .studio-mode-chip {
  background: #1a2539;
}

.dark .studio-mode-chip.is-active {
  border-color: #e2e8f0;
  background: #e2e8f0;
  color: #0f172a;
}

.dark .studio-quality-panel,
.dark .studio-cnn-live-wrap .deep-zone-info,
.dark .studio-cnn-live-wrap .studio-cnn-math-tooltip,
.dark .studio-predict-output-tile,
.dark .studio-cnn-explain-tile,
.dark .studio-output-panel,
.dark .studio-diag-card,
.dark .studio-diag-micro-card,
.dark .studio-flow-panel,
.dark .studio-metrics-details,
.dark .studio-modal-card,
.dark .studio-math-card {
  background: #172235;
}

.dark .studio-network-stage,
.dark .studio-math-empty,
.dark .studio-equation-result,
.dark .studio-network-empty,
.dark .studio-flow-node,
.dark .studio-z-bar-shell {
  background: #1a2539;
}

.dark .studio-term,
.dark .studio-term-empty {
  border-color: #334155;
  background: #101827;
  color: #cbd5e1;
}

.dark .studio-help-dot {
  border-color: #334155;
  background: #1a2539;
  color: #cbd5e1;
}

.dark .studio-help-tip {
  border-color: #334155;
  background: #0f172a;
}

.dark .studio-surface-canvas {
  border-color: #334155;
}

.dark .studio-z-bar-track,
.dark .studio-output-track,
.dark .studio-bar-track,
.dark .studio-mini-bar {
  background: #263246;
}

.dark .studio-flow-model {
  background: #1a2539;
}

.dark .studio-cnn-stage-chip {
  background: #1a2539;
}

.dark .studio-cnn-stage-chip span {
  border-color: #334155;
  background: #0f172a;
  color: #cbd5e1;
}

.dark .studio-cnn-stage-chip.is-active {
  border-color: #e2e8f0;
  color: #0f172a;
  background: #e2e8f0;
}

.dark .studio-cnn-stage-chip.is-active span {
  border-color: #0f172a;
  color: #0f172a;
  background: #e2e8f0;
}

.dark .studio-cnn-compact-pill {
  background: hsl(var(--surface-elevated) / 0.82);
  color: hsl(var(--text-secondary));
}

.dark .studio-cnn-compact-pill.is-active {
  border-color: hsl(var(--accent) / 0.55);
  background: hsl(var(--accent) / 0.2);
  color: hsl(var(--text-primary));
}

.dark .studio-nn-mini-matrix {
  background: #172235;
}

.dark .studio-nn-mini-grid span {
  border-color: #334155;
  background: #0f172a;
  color: #cbd5e1;
}

.dark .studio-flow-model.is-active,
.dark .studio-flow-node.is-active {
  background: #e2e8f0;
  border-color: #e2e8f0;
  color: #0f172a;
}

.dark .studio-flow-node.is-active .studio-flow-index {
  border-color: #0f172a;
}

.dark .studio-modal-backdrop {
  background: rgba(2, 6, 23, 0.72);
}

.dark .studio-cnn-live-wrap .studio-cnn-math-cell {
  border-color: #334155;
  background: #0f172a;
}

.dark .studio-cnn-live-wrap .studio-cnn-math-cell.is-active {
  border-color: #60a5fa;
  background: #13213a;
  box-shadow: inset 0 0 0 1px rgba(96, 165, 250, 0.45);
}

.dark .studio-cnn-live-wrap .studio-cnn-op-list {
  border-top-color: #334155;
}

.dark .studio-textbook-shell,
.dark .studio-textbook-card,
.dark .studio-learn-toolbar,
.dark .studio-unrolled-stage,
.dark .studio-cnn-3d-stage,
.dark .studio-dense-mini,
.dark .studio-flatten-col {
  background: #172235;
}

.dark .studio-compact-control,
.dark .studio-compact-btn {
  background: #1a2539;
  color: #cbd5e1;
}

.dark .studio-unrolled-layer-labels text,
.dark .studio-cnn-stage-block > p {
  fill: #94a3b8;
  color: #94a3b8;
}

.dark .studio-edge-line,
.dark .studio-node-input,
.dark .studio-node-pre,
.dark .studio-node-activation,
.dark .studio-node-hidden,
.dark .studio-node-output,
.dark .studio-flatten-col span,
.dark .studio-dense-mini,
.dark .studio-iso-plane,
.dark .studio-kernel-window {
  border-color: #334155;
}

.dark .studio-node-text {
  fill: #e5e7eb;
}

.dark .studio-inline-math-tip {
  background: rgba(15, 23, 42, 0.88);
  border-color: rgba(148, 163, 184, 0.4);
  color: #e2e8f0;
}

.dark .studio-flatten-col span {
  background: #0f172a;
  color: #94a3b8;
}

.dark .studio-flatten-col span.is-on {
  color: #e2e8f0;
}

.dark .studio-learn2-shell,
.dark .studio-learn2-card,
.dark .studio-learn2-toolbar,
.dark .studio-learn2-nn-stage,
.dark .studio-learn2-cnn-stage,
.dark .studio-learn2-stage {
  background: #172235;
}

.dark .studio-learn2-btn,
.dark .studio-learn2-control {
  background: #1a2539;
  color: #cbd5e1;
}

.dark .studio-learn2-group-label {
  color: #94a3b8;
}

.dark .studio-learn2-btn.is-active {
  background: #e2e8f0;
  color: #0f172a;
  border-color: #e2e8f0;
}

.dark .studio-learn2-label,
.dark .studio-learn2-stage p {
  fill: #94a3b8;
  color: #94a3b8;
}

.dark .studio-learn2-edge {
  stroke: #4b5563;
}

.dark .studio-learn2-node {
  stroke: #334155;
}

.dark .studio-learn2-grid6,
.dark .studio-learn2-grid4,
.dark .studio-learn2-grid2,
.dark .studio-learn2-dense-lines,
.dark .studio-learn2-flat span {
  border-color: #334155;
  background: #0f172a;
}

.dark .studio-learn2-info-card,
.dark .studio-learn2-matrix-panel {
  background: #1a2539;
}

.dark .studio-learn2-info-title,
.dark .studio-learn2-info-copy,
.dark .studio-learn2-info-math,
.dark .studio-learn2-matrix-line {
  color: #cbd5e1;
}

.dark .studio-learn2-grid2 span.is-cnn-focus {
  box-shadow: inset 0 0 0 2px rgba(148, 163, 184, 0.55);
}

.dark .studio-learn2-tip {
  background: rgba(15, 23, 42, 0.92);
  color: #e2e8f0;
  border-color: rgba(148, 163, 184, 0.42);
}

.dark .studio-pad-wrap .deep-step-chip-primary {
  border-color: hsl(var(--accent) / 0.58);
  color: hsl(var(--accent-foreground));
  background: hsl(var(--accent) / 0.34);
  box-shadow: inset 0 0 0 1px hsl(var(--accent) / 0.28);
}

.dark .studio-pad-wrap .deep-step-chip-primary:hover {
  border-color: hsl(var(--accent) / 0.7);
  background: hsl(var(--accent) / 0.42);
}

.dark .studio-learn2-flat span.is-on {
  color: #e2e8f0;
}

@media (max-width: 1080px) {
  .studio-hero {
    grid-template-columns: 1fr;
    gap: 8px;
  }

  .studio-hero-tools {
    justify-items: start;
  }

  .studio-runtime {
    justify-content: flex-start;
    max-width: none;
  }

  .studio-mode-toggle {
    justify-content: flex-start;
  }

  .studio-runtime-pill-optional {
    display: none;
  }

  .studio-quality-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-mlp-layout {
    grid-template-columns: 1fr;
  }

  .studio-mlp-layout-single {
    grid-template-columns: 1fr;
  }

  .studio-predict-layout {
    grid-template-columns: 1fr;
  }

  .studio-math-grid {
    grid-template-columns: 1fr;
  }

  .studio-cnn-grid {
    grid-template-columns: 1fr;
  }

  .studio-cnn-live-wrap .deep-cnn-window-grid {
    grid-template-columns: 1fr;
  }

  .studio-cnn-lane {
    grid-template-columns: repeat(3, minmax(0, 1fr));
    row-gap: 18px;
  }

  .studio-learn2-cnn-lane {
    grid-template-columns: repeat(3, minmax(0, 1fr));
    row-gap: 7px;
  }

  .studio-learn2-cnn-lane.is-large {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-cnn-stage-strip {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }

  .studio-cnn-stage-strip.is-compact {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }

  .studio-cnn-hyper-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-cnn-live-wrap .studio-cnn-output-cluster {
    grid-template-columns: 1fr;
  }

  .studio-cnn-explain-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-diagnostics-grid {
    grid-template-columns: 1fr;
  }

  .studio-diag-micro-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-iso-plane-input {
    width: 132px;
    height: 132px;
  }

  .studio-plane-stack {
    width: 136px;
    height: 114px;
  }

  .studio-plane-stack-pool {
    width: 106px;
    height: 92px;
  }

  .studio-learn2-tip {
    max-width: 90%;
    white-space: normal;
  }

  .studio-nn-control-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-nn-learn-grid {
    grid-template-columns: 1fr;
  }

  .studio-surface-canvas,
  .studio-axis-row {
    max-width: 100%;
    width: 100%;
  }

  .studio-axis-col {
    display: none;
  }
}

@media (max-width: 720px) {
  .studio-quality-grid {
    grid-template-columns: 1fr;
  }

  .studio-hero,
  .studio-card {
    border-radius: 16px;
    padding: 12px;
  }

  .studio-title {
    font-size: 1.08rem;
  }

  .studio-subtitle {
    font-size: 0.82rem;
    line-height: 1.35;
  }

  .studio-runtime-pill {
    font-size: 10px;
    padding: 4px 8px;
  }

  .studio-mode-chip {
    font-size: 10px;
    padding: 4px 8px;
  }

  .studio-network-svg {
    min-width: 540px;
  }

  .studio-term-columns {
    grid-template-columns: 1fr;
  }

  .studio-flow-track {
    grid-template-columns: 1fr;
  }

  .studio-cnn-lane {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-learn2-cnn-lane {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-learn-toolbar {
    gap: 6px;
  }

  .studio-compact-control-range {
    width: 100%;
  }

  .studio-cnn-stage-strip {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-cnn-stage-strip.is-compact {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .studio-cnn-speed-control-compact {
    margin-left: 0;
  }

  .studio-cnn-explain-grid {
    grid-template-columns: 1fr;
  }

  .studio-diag-micro-grid {
    grid-template-columns: 1fr;
  }

  .studio-flow-node::after {
    display: none;
  }

  .studio-flow-dims {
    grid-template-columns: repeat(2, minmax(0, auto));
  }

  .studio-help-tip {
    width: 180px;
  }
}

@media (max-width: 560px) {
  .studio-shell {
    gap: 10px;
  }

  .studio-eyebrow {
    font-size: 10px;
  }

  .studio-subtitle {
    display: none;
  }

  .studio-runtime {
    gap: 5px;
  }

  .studio-runtime-pill {
    font-size: 10px;
    padding: 4px 7px;
    gap: 4px;
  }

  .studio-network-svg {
    min-width: 460px;
  }
}

@media (max-width: 420px) {
  .studio-hero,
  .studio-card {
    border-radius: 14px;
    padding: 10px;
  }

  .studio-title {
    font-size: 1rem;
  }

  .studio-runtime-pill {
    font-size: 9px;
    padding: 3px 6px;
  }

  .studio-mode-chip {
    font-size: 9px;
    padding: 3px 6px;
  }

  .studio-network-svg {
    min-width: 420px;
  }
}

/* God Mode Learn Tab */
.studio-god-shell {
  --learn-match-green: var(--learn-match-green, #22c55e);
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: var(--radius-lg, 20px);
  background: hsl(var(--surface-material, 0 0% 100%) / var(--opacity-material-soft, 0.66));
  backdrop-filter: saturate(130%) blur(var(--blur-md, 16px));
  box-shadow: 0 12px 30px -20px hsl(var(--shadow-soft, 222 22% 35%) / 0.5);
  color: hsl(var(--text-primary, 224 23% 12%));
  font-family: Inter, Roboto, system-ui, sans-serif;
  padding: 10px;
  display: grid;
  gap: 10px;
}

.studio-god-toolbar {
  display: grid;
  grid-template-columns: auto auto 1fr;
  align-items: center;
  gap: 8px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: var(--radius-md, 16px);
  background: hsl(var(--surface-material, 0 0% 100%) / var(--opacity-material-soft, 0.66));
  backdrop-filter: saturate(130%) blur(var(--blur-sm, 10px));
  box-shadow: 0 10px 28px -24px hsl(var(--shadow-soft, 222 22% 35%) / 0.6);
  padding: 6px;
}

.studio-god-toggle,
.studio-god-controls {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 999px;
  background: hsl(var(--surface-material, 0 0% 100%) / var(--opacity-material-soft, 0.66));
  backdrop-filter: saturate(130%) blur(var(--blur-sm, 10px));
}

.studio-god-tab,
.studio-god-btn {
  border: 1px solid transparent;
  background: transparent;
  color: hsl(var(--text-secondary, 221 20% 26%));
  border-radius: 999px;
  font-size: 11px;
  font-weight: 600;
  line-height: 1;
  padding: 6px 10px;
  transition:
    color var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    background var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    transform var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    box-shadow var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    border-color var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1));
}

.studio-god-tab:hover,
.studio-god-btn:hover {
  background: hsl(var(--surface-muted, 220 20% 95%));
  color: hsl(var(--text-primary, 224 23% 12%));
  transform: translateY(-0.5px);
}

.studio-god-tab.is-active {
  border-color: hsl(var(--border-subtle, 218 20% 88%));
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.96);
  color: hsl(var(--text-primary, 224 23% 12%));
  box-shadow: 0 6px 16px -12px hsl(var(--shadow-medium, 223 21% 24%) / 0.7);
}

.studio-god-btn:focus-visible,
.studio-god-tab:focus-visible {
  outline: none;
  box-shadow:
    0 0 0 2px hsl(var(--accent, 215 90% 52%) / 0.2),
    0 0 0 4px hsl(var(--accent, 215 90% 52%) / 0.14);
}

.studio-god-hyperparams {
  margin-left: auto;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}

.studio-god-param {
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: var(--radius-md, 16px);
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.84);
  color: hsl(var(--text-secondary, 221 20% 26%));
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 5px 9px;
  font-size: 10px;
  box-shadow: inset 0 1px 0 hsl(var(--foreground, 224 23% 12%) / 0.02);
}

.studio-god-param input {
  width: 88px;
  accent-color: hsl(var(--accent, 215 90% 52%));
}

.studio-god-param-target {
  gap: 8px;
}

.studio-god-mini-toggle {
  display: inline-flex;
  align-items: center;
  gap: 3px;
  padding: 2px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 999px;
  background: hsl(var(--surface-material, 0 0% 100%) / var(--opacity-material-soft, 0.66));
}

.studio-god-mini-btn {
  border: 1px solid transparent;
  background: transparent;
  color: hsl(var(--text-secondary, 221 20% 26%));
  border-radius: 999px;
  padding: 4px 8px;
  font-size: 10px;
  font-weight: 600;
  line-height: 1;
  cursor: pointer;
  transition:
    color var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    background var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    border-color var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1));
}

.studio-god-mini-btn:hover {
  background: hsl(var(--surface-muted, 220 20% 95%));
  color: hsl(var(--text-primary, 224 23% 12%));
}

.studio-god-mini-btn.is-active {
  border-color: hsl(var(--border-subtle, 218 20% 88%));
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.96);
  color: hsl(var(--text-primary, 224 23% 12%));
}

.studio-god-canvas {
  position: relative;
  min-height: 460px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: var(--radius-lg, 20px);
  background:
    radial-gradient(560px 200px at 5% 0%, hsl(var(--accent, 215 90% 52%) / 0.1), transparent 72%),
    hsl(var(--surface-material, 0 0% 100%) / var(--opacity-material-soft, 0.66));
  backdrop-filter: saturate(125%) blur(var(--blur-md, 16px));
  padding: 10px;
}

.studio-god-module {
  display: grid;
  gap: 10px;
}

.studio-god-module.is-hidden {
  display: none;
}

.studio-god-module-title {
  margin: 0;
  font-size: 0.92rem;
  color: hsl(var(--text-primary, 224 23% 12%));
}

.studio-god-module-flow {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 6px;
  line-height: 1;
}

.studio-god-flow-step {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.studio-god-flow-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-height: 28px;
  padding: 5px 11px;
  border-radius: 999px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  background:
    linear-gradient(180deg, hsl(var(--surface-elevated, 0 0% 100%) / 0.96), hsl(var(--surface-material, 0 0% 100%) / 0.84));
  color: hsl(var(--text-secondary, 221 20% 26%));
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 0.01em;
  box-shadow: 0 8px 14px -16px hsl(var(--shadow-medium, 223 21% 24%) / 0.72);
  transition:
    border-color var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    background var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    color var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    transform var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    box-shadow var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1));
}

.studio-god-flow-pill.is-reached {
  border-color: hsl(var(--accent, 215 90% 52%) / 0.45);
  background:
    linear-gradient(180deg, hsl(var(--accent, 215 90% 52%) / 0.16), hsl(var(--accent, 215 90% 52%) / 0.1));
  color: hsl(var(--text-primary, 224 23% 12%));
}

.studio-god-flow-pill.is-active {
  border-color: hsl(var(--accent, 215 90% 52%) / 0.62);
  background:
    linear-gradient(180deg, hsl(var(--accent, 215 90% 52%) / 0.24), hsl(var(--accent, 215 90% 52%) / 0.16));
  color: hsl(var(--text-primary, 224 23% 12%));
  box-shadow:
    inset 0 0 0 1px hsl(var(--accent, 215 90% 52%) / 0.25),
    0 10px 18px -18px hsl(var(--shadow-medium, 223 21% 24%) / 0.88);
}

.studio-god-flow-arrow {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: hsl(var(--text-tertiary, 220 15% 36%));
  font-weight: 700;
  font-size: 14px;
  line-height: 1;
  transform: translateY(-0.5px);
  user-select: none;
}

.studio-god-nn-chain {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 4px;
}

.studio-god-chain-chip {
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 999px;
  padding: 5px 8px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.84);
  color: hsl(var(--text-secondary, 221 20% 26%));
  font-size: 10px;
  box-shadow: 0 8px 14px -16px hsl(var(--shadow-medium, 223 21% 24%) / 0.7);
}

.studio-god-chain-chip em {
  font-style: normal;
  opacity: 0.55;
}

.studio-god-chain-chip.is-active {
  border-color: hsl(var(--accent, 215 90% 52%) / 0.52);
  background: hsl(var(--accent, 215 90% 52%) / 0.12);
  color: hsl(var(--text-primary, 224 23% 12%));
}

.studio-god-chain-backprop {
  margin-left: 4px;
}

.studio-god-nn-svg {
  width: 100%;
  min-height: 250px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: var(--radius-md, 16px);
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.82);
  box-shadow: 0 8px 18px -20px hsl(var(--shadow-soft, 222 22% 35%) / 0.45);
}

.studio-god-neuron {
  fill: color-mix(in srgb, var(--bg, #ffffff) 80%, var(--text, #0f172a) 20%);
  stroke: var(--glass-border, rgba(15, 23, 42, 0.14));
  stroke-width: 1.4;
}

.studio-god-neuron.neuron-input {
  fill: color-mix(in srgb, #3b82f6 28%, var(--bg, #ffffff));
  stroke: color-mix(in srgb, #3b82f6 45%, var(--glass-border, rgba(15, 23, 42, 0.14)));
}

.studio-god-neuron.neuron-h1 {
  fill: color-mix(in srgb, #f59e0b 26%, var(--bg, #ffffff));
  stroke: color-mix(in srgb, #f59e0b 45%, var(--glass-border, rgba(15, 23, 42, 0.14)));
}

.studio-god-neuron.neuron-h2 {
  fill: color-mix(in srgb, #10b981 24%, var(--bg, #ffffff));
  stroke: color-mix(in srgb, #10b981 44%, var(--glass-border, rgba(15, 23, 42, 0.14)));
}

.studio-god-neuron.neuron-out {
  fill: color-mix(in srgb, #ef4444 22%, var(--bg, #ffffff));
  stroke: color-mix(in srgb, #ef4444 44%, var(--glass-border, rgba(15, 23, 42, 0.14)));
}

.studio-god-edge {
  stroke: var(--text, #0f172a);
  stroke-opacity: 0.14;
  stroke-width: 1;
}

.studio-god-edge-active {
  stroke: var(--text, #0f172a);
  stroke-opacity: 0.9;
  stroke-width: 1.7;
}

.studio-god-edge-active.is-backprop {
  stroke-dasharray: 4 3;
  animation: studioGodBackFlow 600ms linear infinite;
}

@keyframes studioGodBackFlow {
  from {
    stroke-dashoffset: 0;
  }
  to {
    stroke-dashoffset: -14;
  }
}

.studio-god-layer-title {
  fill: hsl(var(--text-primary, 224 23% 12%));
  opacity: 0.68;
  font-size: 11px;
  text-anchor: middle;
}

.studio-god-packet {
  fill: color-mix(in srgb, #06b6d4 62%, var(--bg, #ffffff));
  filter: drop-shadow(0 0 10px color-mix(in srgb, #06b6d4 75%, transparent));
}

.studio-god-nn-math-panels {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.studio-god-nnscene {
  position: relative;
  height: min(58vh, 520px);
  min-height: 360px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: var(--radius-md, 16px);
  background:
    radial-gradient(560px 180px at 8% -8%, hsl(var(--accent, 215 90% 52%) / 0.12), transparent 70%),
    hsl(var(--surface-elevated, 0 0% 100%) / 0.82);
  overflow: hidden;
}

.studio-god-nnscene-grid {
  position: absolute;
  inset: -60% -40%;
  background-image:
    linear-gradient(hsl(var(--border-subtle, 218 20% 88%) / 0.35) 1px, transparent 1px),
    linear-gradient(90deg, hsl(var(--border-subtle, 218 20% 88%) / 0.35) 1px, transparent 1px);
  background-size: 32px 32px;
  pointer-events: none;
}

.studio-god-nnscene-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}

.studio-god-nnscene-cheat {
  position: absolute;
  left: 12px;
  top: 12px;
  width: 206px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 12px;
  background: hsl(var(--surface-material, 0 0% 100%) / var(--opacity-material-mid, 0.78));
  backdrop-filter: saturate(130%) blur(var(--blur-sm, 10px));
  padding: 10px;
  z-index: 4;
}

.studio-god-nnscene-cheat h4 {
  margin: 0;
  font-size: 0.78rem;
  color: hsl(var(--text-primary, 224 23% 12%));
}

.studio-god-nnscene-cheat p {
  margin: 6px 0 0;
  font-size: 11px;
  line-height: 1.4;
  color: hsl(var(--text-secondary, 221 20% 26%));
}

.studio-god-nnscene-cheat ul {
  margin: 8px 0 0;
  padding-left: 0;
  list-style: none;
  display: grid;
  gap: 4px;
  font-size: 11px;
  color: hsl(var(--text-secondary, 221 20% 26%));
}

.studio-god-nnscene-cheat strong {
  display: inline-block;
  width: 14px;
  color: hsl(var(--accent, 215 90% 52%));
}

.studio-god-nnscene-float {
  position: absolute;
  width: min(430px, calc(100% - 22px));
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 10px;
  background: hsl(var(--surface-material, 0 0% 100%) / var(--opacity-material-mid, 0.78));
  backdrop-filter: saturate(130%) blur(var(--blur-sm, 10px));
  padding: 8px 10px;
  transform: translateX(-50%);
  z-index: 7;
  box-shadow: 0 14px 28px -24px hsl(var(--shadow-medium, 223 21% 24%) / 0.75);
}

.studio-god-nnscene-float.is-forward {
  border-color: hsl(198 93% 45% / 0.48);
  box-shadow: 0 0 0 1px hsl(198 93% 45% / 0.15), 0 14px 28px -24px hsl(var(--shadow-medium, 223 21% 24%) / 0.75);
}

.studio-god-nnscene-float.is-backprop {
  border-color: hsl(343 86% 55% / 0.45);
  box-shadow: 0 0 0 1px hsl(343 86% 55% / 0.15), 0 14px 28px -24px hsl(var(--shadow-medium, 223 21% 24%) / 0.75);
}

.studio-god-nnscene-float-top {
  top: 12px;
  max-height: 124px;
  overflow: auto;
}

.studio-god-nnscene-float-bottom {
  bottom: 12px;
  max-height: 152px;
  overflow: auto;
}

.studio-god-nnscene-phase {
  margin: 0;
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-weight: 700;
  color: hsl(var(--accent, 215 90% 52%));
}

.studio-god-nnscene-english {
  margin: 4px 0 0;
  font-size: 12px;
  line-height: 1.38;
  color: hsl(var(--text-primary, 224 23% 12%));
}

.studio-god-nnscene-math {
  margin: 6px 0 0;
  font-size: 11px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 8px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.86);
  padding: 5px 7px;
  color: hsl(var(--text-secondary, 221 20% 26%));
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
}

.studio-god-nnscene-example-head {
  margin: 0;
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-weight: 700;
  color: hsl(var(--text-tertiary, 220 15% 36%));
}

.studio-god-nnscene-example {
  margin: 6px 0 0;
  font-size: 10px;
  line-height: 1.38;
  white-space: pre-wrap;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 8px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.86);
  color: hsl(var(--text-secondary, 221 20% 26%));
  padding: 7px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  max-height: 98px;
  overflow: auto;
}

.studio-god-nnscene-tooltip {
  position: absolute;
  width: 270px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 10px;
  background: hsl(var(--surface-material, 0 0% 100%) / var(--opacity-material-strong, 0.9));
  backdrop-filter: saturate(130%) blur(var(--blur-sm, 10px));
  padding: 10px;
  transform: translateY(-50%);
  box-shadow: 0 20px 38px -30px hsl(var(--shadow-medium, 223 21% 24%) / 0.9);
  pointer-events: none;
  opacity: 0;
  transition: opacity 150ms ease;
  z-index: 6;
}

.studio-god-nnscene-tooltip.is-visible {
  opacity: 1;
}

.studio-god-nnscene-tooltip h5 {
  margin: 0;
  font-size: 12px;
  color: hsl(var(--accent, 215 90% 52%));
}

.studio-god-nnscene-tooltip p {
  margin: 4px 0 0;
  font-size: 11px;
  color: hsl(var(--text-secondary, 221 20% 26%));
}

.studio-god-nnscene-tooltip-calc {
  margin-top: 6px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 8px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.86);
  padding: 6px;
  display: grid;
  gap: 2px;
}

.studio-god-nnscene-tooltip-calc span {
  font-size: 10px;
  color: hsl(var(--text-secondary, 221 20% 26%));
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
}

.studio-god-nnscene-tooltip-out {
  margin-top: 7px;
  font-size: 12px;
  font-weight: 700;
  color: #16a34a;
}

.studio-god-math-card {
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: var(--radius-md, 16px);
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.84);
  color: hsl(var(--text-primary, 224 23% 12%));
  padding: 8px;
  min-width: 240px;
}

.studio-god-math-card h4 {
  margin: 0;
  font-size: 0.78rem;
}

.studio-god-math-card p {
  margin: 4px 0 0;
  font-size: 0.72rem;
}

.studio-god-activation-graph {
  width: 170px;
  height: auto;
}

.studio-god-graph-axis,
.studio-god-graph-curve {
  fill: none;
  stroke: var(--text, #0f172a);
}

.studio-god-graph-axis {
  stroke-opacity: 0.4;
  stroke-width: 1;
}

.studio-god-graph-curve {
  stroke-opacity: 0.9;
  stroke-width: 2;
}

.studio-god-softmax-bars {
  display: grid;
  gap: 5px;
}

.studio-god-softmax-bars span {
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 999px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.84);
  color: hsl(var(--text-secondary, 221 20% 26%));
  font-size: 10px;
  font-weight: 700;
  padding: 4px 8px;
  min-width: 140px;
}

.studio-god-cnn-root {
  --cnn-cell-size: 5px;
  position: relative;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: var(--radius-md, 16px);
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.82);
  padding: 10px;
  min-height: 292px;
  overflow: hidden;
  box-shadow: 0 8px 18px -20px hsl(var(--shadow-soft, 222 22% 35%) / 0.45);
}

.studio-god-frustum-svg {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 8;
  will-change: contents;
}

.studio-god-frustum-face {
  fill: var(--text, #0f172a);
  fill-opacity: 0.2;
  stroke: var(--text, #0f172a);
  stroke-opacity: 0.42;
  stroke-width: 1;
  filter: drop-shadow(0 0 2px color-mix(in srgb, var(--text, #0f172a) 36%, transparent));
  shape-rendering: geometricPrecision;
}

.studio-god-scan-window {
  position: absolute;
  border: 2px solid var(--text, #0f172a);
  background: var(--glass-bg, rgba(255, 255, 255, 0.7));
  border-radius: 4px;
  opacity: 0;
  pointer-events: none;
  transition: left 90ms linear, top 90ms linear, width 120ms ease, height 120ms ease, opacity 90ms ease;
  z-index: 9;
  will-change: left, top, width, height;
}

.studio-god-cnn-perspective {
  position: relative;
  z-index: 1;
  perspective: 1000px;
  display: flex;
  flex-wrap: nowrap;
  gap: 6px;
  align-items: start;
  align-content: flex-start;
  transition: gap 200ms ease;
}

.studio-god-cnn-perspective > .studio-god-layer-card {
  flex: 0 0 auto;
}

.studio-god-layer-card {
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: var(--radius-md, 16px);
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.82);
  padding: 7px;
  display: grid;
  gap: 6px;
  min-height: 0;
  height: auto;
  width: fit-content;
  max-width: 240px;
  align-content: start;
  overflow: hidden;
  transition:
    transform var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    opacity var(--duration-base, 220ms) var(--spring-soft, cubic-bezier(0.22, 1, 0.36, 1)),
    border-color var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1)),
    box-shadow var(--duration-fast, 150ms) var(--spring-snappy, cubic-bezier(0.2, 0.8, 0.2, 1));
  box-shadow: 0 8px 14px -16px hsl(var(--shadow-medium, 223 21% 24%) / 0.7);
}

.studio-god-card-input {
  width: 188px;
  max-width: 188px;
}

.studio-god-card-conv {
  width: 176px;
  max-width: 176px;
}

.studio-god-card-act {
  width: 176px;
  max-width: 176px;
}

.studio-god-card-pool {
  width: 142px;
  max-width: 142px;
}

.studio-god-card-flatten {
  width: 132px;
  max-width: 132px;
}

.studio-god-card-dense {
  width: 196px;
  max-width: 196px;
}

.studio-god-card-output {
  width: 138px;
  max-width: 138px;
}

.studio-god-card-active {
  max-width: none;
}

.studio-god-layer-card.is-pending {
  opacity: 0.52;
}

.studio-god-layer-card.is-ready {
  opacity: 0.9;
}

.studio-god-card-context {
  opacity: 0.9;
  border-style: solid;
  border-color: color-mix(in srgb, var(--glass-border, rgba(15, 23, 42, 0.14)) 82%, transparent);
  transform: translateY(2px);
}

.studio-god-card-context .studio-god-layer-grid {
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--glass-border, rgba(15, 23, 42, 0.14)) 72%, transparent);
}

.studio-god-card-conv.is-source-swap .studio-god-layer-grid {
  animation: studioGodSwapPulse 460ms ease;
}

@keyframes studioGodSwapPulse {
  0% {
    opacity: 0.45;
    transform: scale(0.95);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

.studio-god-layer-card.is-active {
  border-color: hsl(var(--accent, 215 90% 52%) / 0.55);
  box-shadow:
    inset 0 0 0 1px hsl(var(--accent, 215 90% 52%) / 0.2),
    0 12px 20px -20px hsl(var(--shadow-medium, 223 21% 24%) / 0.78);
}

.studio-god-layer-card p {
  margin: 0;
  font-size: 10px;
  color: hsl(var(--text-tertiary, 220 15% 36%));
  opacity: 0.74;
  text-transform: uppercase;
  letter-spacing: 0.03em;
}

.studio-god-layer-grid {
  position: relative;
  display: inline-grid;
  gap: 1px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 8px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.88);
  padding: 4px;
  transform: none;
  transform-style: flat;
  transform-origin: center;
  width: fit-content;
  margin-inline: auto;
  overflow: hidden;
}

.studio-god-grid-10 {
  grid-template-columns: repeat(10, minmax(0, 1fr));
}

.studio-god-grid-8 {
  grid-template-columns: repeat(8, minmax(0, 1fr));
}

.studio-god-grid-4 {
  grid-template-columns: repeat(4, minmax(0, 1fr));
}

.studio-god-grid-3 {
  grid-template-columns: repeat(3, minmax(0, 1fr));
}

.studio-god-grid-2 {
  grid-template-columns: repeat(2, minmax(0, 1fr));
}

.studio-god-layer-grid span {
  width: var(--cnn-cell-size, 6px);
  height: var(--cnn-cell-size, 6px);
  border-radius: 2px;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%) / 0.85);
  background: hsl(var(--surface-muted, 220 20% 95%));
  color: hsl(var(--text-primary, 224 23% 12%));
  display: grid;
  place-items: center;
  font-size: clamp(6px, 0.42vw, 8px);
  line-height: 1;
  font-variant-numeric: tabular-nums;
  padding: 0;
  transition: opacity 180ms ease, transform 180ms ease;
}

.studio-god-layer-grid span.is-dim {
  opacity: 0.18;
  transform: scale(0.94);
}

.studio-god-flat-targets {
  position: relative;
  display: grid;
  gap: 5px 10px;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  align-content: start;
  max-height: none;
  overflow: hidden;
}

.studio-god-flat-targets::after {
  content: '';
  position: absolute;
  top: 2px;
  bottom: 2px;
  left: 50%;
  width: 1px;
  background: hsl(var(--border-subtle, 218 20% 88%));
  pointer-events: none;
}

.studio-god-flat-targets span {
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 6px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.84);
  color: hsl(var(--text-primary, 224 23% 12%));
  text-align: center;
  font-size: 10px;
  padding: 6px 4px;
  opacity: 0;
  transform: translateX(10px);
  transition: opacity 220ms ease, transform 240ms ease;
}

.studio-god-flat-targets span.is-show {
  opacity: 1;
  transform: translateX(0);
}

.studio-god-stage-tile {
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 7px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.84);
  color: hsl(var(--text-secondary, 221 20% 26%));
  font-size: 9.2px;
  line-height: 1.32;
  padding: 6px 7px;
  min-height: 40px;
}

.studio-god-stage-tile strong {
  font-weight: 700;
}

.studio-god-dense-svg {
  width: 100%;
  height: 146px;
}

.studio-god-dense-node {
  fill: hsl(var(--surface-elevated, 0 0% 100%) / 0.82);
  stroke: hsl(var(--border-subtle, 218 20% 88%));
  stroke-width: 1;
}

.studio-god-dense-node.is-in {
  fill: color-mix(in srgb, #0ea5e9 34%, var(--bg, #ffffff));
}

.studio-god-dense-node.is-hidden {
  fill: color-mix(in srgb, #f59e0b 30%, var(--bg, #ffffff));
}

.studio-god-dense-node.is-out {
  fill: color-mix(in srgb, #8b5cf6 40%, var(--bg, #ffffff));
}

.studio-god-dense-edge {
  stroke: hsl(var(--text-primary, 224 23% 12%));
  stroke-opacity: 0.75;
  stroke-width: 1.3;
}

.studio-god-dense-readout {
  display: grid;
  gap: 6px;
}

.studio-god-dense-readout span {
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 9px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.86);
  color: hsl(var(--text-primary, 224 23% 12%));
  text-align: left;
  font-size: 9.8px;
  font-weight: 650;
  padding: 5px 7px;
  white-space: normal;
  overflow-wrap: anywhere;
}

.studio-god-dense-readout span.is-win {
  border-color: hsl(var(--accent, 215 90% 52%) / 0.6);
  box-shadow: inset 0 0 0 1px hsl(var(--accent, 215 90% 52%) / 0.18);
}

.studio-god-dense-readout span.is-smile {
  background: color-mix(in srgb, #10b981 20%, var(--glass-bg, rgba(255, 255, 255, 0.7)));
}

.studio-god-dense-readout span.is-frown {
  background: color-mix(in srgb, #f97316 18%, var(--glass-bg, rgba(255, 255, 255, 0.7)));
}

.studio-god-output-emoji {
  font-size: 30px;
  text-align: center;
  line-height: 1;
}

.studio-god-unzip-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 4;
}

.studio-god-unzip-overlay span {
  position: absolute;
  display: grid;
  place-items: center;
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  border-radius: 5px;
  background: hsl(var(--surface-elevated, 0 0% 100%) / 0.84);
  color: hsl(var(--text-primary, 224 23% 12%));
  font-size: 9px;
  opacity: 0;
  transform: translate(0, 0);
  transition: transform 560ms ease, opacity 240ms ease;
}

.studio-god-unzip-overlay span.is-show {
  opacity: 0.9;
}

.studio-god-unzip-overlay span.is-column {
  transform: translate(var(--ux), var(--uy));
}

.studio-god-tooltip {
  position: absolute;
  left: 10px;
  top: 10px;
  width: min(340px, 92vw);
  background: hsl(var(--surface-material, 0 0% 100%) / var(--opacity-material-mid, 0.78));
  backdrop-filter: saturate(130%) blur(var(--blur-sm, 10px));
  border: 1px solid hsl(var(--border-subtle, 218 20% 88%));
  color: hsl(var(--text-primary, 224 23% 12%));
  border-radius: 8px;
  padding: 9px 10px;
  pointer-events: none;
  transform: translate(0, -50%);
  z-index: 6;
}

.studio-god-tooltip.is-cnn-docked {
  transform: none;
  width: 288px;
  max-height: calc(100% - 24px);
  overflow: auto;
}

.studio-god-tooltip h4 {
  margin: 0;
  font-size: 0.8rem;
}

.studio-god-tooltip-body {
  margin: 5px 0 0;
  font-size: 0.75rem;
  line-height: 1.4;
}

.studio-god-tip-meta {
  font-size: 11px;
  opacity: 0.82;
  margin-bottom: 6px;
  letter-spacing: 0.01em;
}

.studio-god-tip-grid-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}

.studio-god-tip-block {
  display: grid;
  gap: 4px;
}

.studio-god-tip-grid-row strong {
  display: block;
  font-size: 10px;
  margin-bottom: 2px;
  text-transform: uppercase;
  opacity: 0.76;
}

.studio-god-tip-matrix {
  display: grid;
  gap: 2px;
  padding: 4px;
  border: 1px solid var(--glass-border, rgba(15, 23, 42, 0.14));
  border-radius: 6px;
  background: color-mix(in srgb, var(--glass-bg, rgba(255, 255, 255, 0.7)) 85%, transparent);
}

.studio-god-tip-matrix span {
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 10px;
  white-space: nowrap;
  display: inline-flex;
  gap: 4px;
}

.studio-god-tip-val {
  font-style: normal;
  font-weight: 600;
}

.studio-god-tip-matrix.is-kernel .studio-god-tip-val.is-pos {
  color: color-mix(in srgb, #ef4444 72%, var(--text, #0f172a));
}

.studio-god-tip-matrix.is-kernel .studio-god-tip-val.is-neg {
  color: color-mix(in srgb, #2563eb 76%, var(--text, #0f172a));
}

.studio-god-tip-matrix.is-kernel .studio-god-tip-val.is-zero {
  color: color-mix(in srgb, var(--text, #0f172a) 62%, transparent);
}

.studio-god-tip-formula {
  margin-top: 7px;
  border: 1px solid var(--glass-border, rgba(15, 23, 42, 0.14));
  border-radius: 6px;
  padding: 6px 8px;
  font-size: 11px;
  background: color-mix(in srgb, var(--glass-bg, rgba(255, 255, 255, 0.7)) 84%, transparent);
}

.studio-god-tip-formula b {
  font-size: 12px;
}

.studio-god-tip-result {
  margin-top: 6px;
  font-weight: 700;
  font-size: 11px;
  color: color-mix(in srgb, var(--text, #0f172a) 78%, transparent);
}

.studio-god-tip-result.is-match {
  color: var(--learn-match-green);
}

.studio-god-stage-wait {
  border: 1px dashed var(--glass-border, rgba(15, 23, 42, 0.3));
  border-radius: 8px;
  padding: 14px 10px;
  font-size: 11px;
  color: color-mix(in srgb, var(--text, #0f172a) 70%, transparent);
  text-align: center;
  min-width: 130px;
}

.studio-god-vline-icon {
  display: inline-block;
  padding: 0 3px;
  font-weight: 900;
}

.studio-god-tooltip.is-pulse-green {
  box-shadow: 0 0 0 1px var(--learn-match-green), 0 0 20px color-mix(in srgb, var(--learn-match-green) 55%, transparent);
}

@media (max-width: 1080px) {
  .studio-god-toolbar {
    grid-template-columns: 1fr;
    justify-items: start;
  }

  .studio-god-hyperparams {
    margin-left: 0;
  }

  .studio-god-cnn-perspective {
    flex-wrap: wrap;
    gap: 8px;
  }

  .studio-god-cnn-root {
    padding-right: 12px;
  }

  .studio-god-tooltip.is-cnn-docked {
    width: min(320px, 90vw);
  }

  .studio-god-nnscene {
    height: min(52vh, 500px);
  }

  .studio-god-nnscene-cheat {
    width: 186px;
  }
}

@media (max-width: 720px) {
  .studio-god-canvas {
    min-height: 740px;
  }

  .studio-god-param {
    width: 100%;
    justify-content: space-between;
  }

  .studio-god-flow-pill {
    min-height: 24px;
    padding: 4px 9px;
    font-size: 11px;
  }

  .studio-god-flow-arrow {
    font-size: 12px;
  }

  .studio-god-nnscene {
    min-height: 420px;
    height: 520px;
  }

  .studio-god-nnscene-cheat {
    display: none;
  }

  .studio-god-nnscene-float {
    width: min(300px, calc(100% - 14px));
  }

  .studio-god-nnscene-tooltip {
    width: min(260px, calc(100% - 16px));
  }
}

@media (max-width: 560px) {
  .studio-god-nnscene {
    min-height: 400px;
    height: 500px;
  }

  .studio-god-tooltip {
    width: min(300px, 95vw);
  }
}

